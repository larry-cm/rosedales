---
import Carousel from "../components/Carousel";
import FondoBg from "../components/FondoBg.astro";
import LogoRosedal from "../assets/LogoRosedal.astro";
import type { objetosSlides } from "@type/global";

interface Props {
    images: objetosSlides;
}
const { images } = Astro.props;
---

<section class="p-8 overflow-x-hidden">
    <!-- texto sobre nosotros -->
    <h3
        class="mb-10 text-center text-4xl text-black font-medium tracking-wider"
    >
        Contamos con <b class="font-bold">espacios únicos </b>para ti
    </h3>
    <article
        class="relative flex flex-col md:flex-row gap-6 mt-8 text-xl md:text-2xl leading-relaxed mb-[1lh]"
    >
        <div
            class="order-1 text-xl md:text-2xl *:leading-relaxed text-pretty text-zinc-700 space-y-[1lh] lg:w-2/3"
        >
            <p>
                Somos un centro comercial pensado para ti, te ofrecemos una
                <b class="text-green-500">experiencia segura y gratificante</b>,
                moderna y de alta calidad.
            </p>
            <p>
                Contamos con espacios amplios, atención al cliente personalizada
                y una cuidada selección de <b
                    class="text-green-500 font-semibold">marcas</b
                > y <b class="text-green-500 font-semibold">productos</b>,
                pensados para satisfacer cada una de tus necesidades.
            </p>
        </div>

        <div
            class="flex flex-col justify-center animation-slide-right select-none text-black order-2 gap-6 w-full md:w-full lg:w-1/3 md:mx-auto h-min my-auto"
        >
            <h4
                class="flex items-center justify-center text-nowrap font-bold md:text-7xl text-5xl drop-shadow-2xl drop-shadow-zinc-800/30"
            >
                <span>+</span>
                <span class="text-green-500">50</span>
                <span class="text-5xl md:text-7xl text-zinc-700 ms-2">años</span
                >
            </h4>
            <small
                class="text-xl tracking-wider capitalize text-pretty font-bold text-center"
            >
                Brindándote los mejores productos
            </small>
        </div>
    </article>
    <article class="flex items-center flex-col lg:flex-row gap-6 mb-14">
        <div class="order-2 lg:order-1 animation-slide-left select-none">
            <Carousel
                autoSlide
                slides={images.slice(1)}
                type="img"
                visibleSlides={1}
                classImg="object-contain aspect-video"
                style="w-full lg:w-[450px] rounded-xl h-auto"
                chevronClass="size-6"
                buttonClass="p-1 bg-green-500 rounded-xl text-white cursor-pointer active:scale-95"
                client:visible
            />
        </div>
        <div
            class="order-1 lg:order-2 text-xl md:text-2xl *:leading-relaxed space-y-[1lh] text-pretty text-zinc-700"
        >
            <p>
                Aquí, entre pasillos que guardan el eco de una tradición
                comercial, se fusionan la historia y la <b
                    class="text-green-500 font-semibold">modernidad</b
                >, ofreciendo la calidez del trato cercano y la <b
                    class="text-green-500 font-semibold">variedad</b
                > que solo el comercio tradicional puede brindar.
            </p>
            <p>
                Más que una experiencia de compra, es un recorrido por la
                memoria viva de la ciudad, donde cada local narra una parte del
                ayer mientras exhibe <b
                    id="contáctenos"
                    class="text-green-500 font-semibold"
                    >las mejores ofertas de hoy</b
                >.
            </p>
        </div>
    </article>
    <!-- formulario de contáctenos -->
    <article
        class="bg-green-500 z-10 overflow-hidden relative rounded-4xl p-8 py-18"
    >
        <FondoBg position="-bottom-16 right-3 sm:bottom-3 sm:left-3" />
        <FondoBg position="-right-20 -top-15 sm:right-4 sm:-top-20" />
        <form class="max-w-xl mx-auto">
            <div class="flex sm:flex-row flex-col justify-evenly mb-4 gap-4">
                <h4
                    class="order-2 sm:order-1 text-2xl sm:text-5xl text-zinc-100 text-pretty font-semibold tracking-wider"
                >
                    Comuníquenos
                </h4>
                <i
                    class="flex order-1 sm:order-2 me-auto w-fit md:*:w-40 *:w-32"
                >
                    <LogoRosedal fill="#fff" />
                </i>
            </div>
            <section class="space-y-3 *:block">
                <label>
                    <legend class="sr-only">Nombre:</legend>
                    <input
                        type="text"
                        name="nombre"
                        placeholder="Nombre"
                        class="rounded-xl text-xs w-full placeholder:font-semibold bg-white placeholder:text-xs sm:placeholder:text-lg px-6 py-2.5 sm:text-lg"
                    />
                </label>
                <label>
                    <legend class="sr-only">Correo:</legend>
                    <input
                        type="text"
                        name="correo"
                        placeholder="Correo Electrónico"
                        class="rounded-xl text-xs w-full placeholder:font-semibold bg-white placeholder:text-xs sm:placeholder:text-lg px-6 py-2.5 sm:text-lg"
                    />
                </label>
                <label>
                    <legend class="sr-only">Asunto:</legend>
                    <input
                        type="text"
                        name="asunto"
                        placeholder="Asunto o recomendación"
                        class="rounded-xl text-xs w-full placeholder:font-semibold bg-white ring ring-green-500 placeholder:text-xs sm:placeholder:text-lg px-6 py-2.5 sm:text-lg"
                    />
                </label>
                <textarea
                    name="mensaje"
                    rows="3"
                    class="field rounded-xl text-xs w-full placeholder:font-semibold bg-white ring ring-green-500 placeholder:text-xs sm:placeholder:text-lg px-6 py-2.5 sm:text-lg"
                    placeholder="Mensaje referente al asunto o recomendación"
                ></textarea>
                <div class="mt-6 space-y-3">
                    <div
                        class="flex gap-2 select-text bg-zinc-100 shadow p-4 rounded-xl"
                    >
                        <input
                            id="privacidad-check"
                            type="checkbox"
                            name="privacidad-check"
                            class="block size-4 p-2 select-none"
                        />
                        <label
                            for="privacidad-check"
                            class="text-xs font-semibold block text-pretty flex-1 text-zinc-600"
                        >
                            Acepto política de tratamiento de datos personales.
                        </label>
                    </div>
                    <button
                        type="submit"
                        class="items-center justify-center w-full px-6 py-2.5 text-center text-black font-semibold duration-200 bg-white border-2 border-white rounded-xl inline-flex hover:bg-transparent hover:border-white hover:text-white focus:outline-none focus-visible:outline-white text-sm focus-visible:ring-white cursor-pointer"
                        >Enviar</button
                    >
                </div>
            </section>
        </form>
    </article>
</section>
<style>
    .field {
        field-sizing: content;
        min-height: 4lh;
    }
</style>
<!-- No se inicia la animación automáticamente: se activa al entrar en viewport -->
<style>
    .animation-slide-right {
        opacity: 0;
        will-change: transform, opacity;
    }
    .animation-slide-right.in-view {
        animation: slideRight 1s linear both;
    }

    .animation-slide-left {
        opacity: 0;
        will-change: transform, opacity;
    }
    .animation-slide-left.in-view {
        animation: slideLeft 1s 0.4s linear both;
    }

    @keyframes slideLeft {
        0% {
            opacity: 0;
            transform: translateX(-90px);
        }
        100% {
            opacity: 1;
            transform: translateX(0);
        }
    }
    @keyframes slideRight {
        0% {
            opacity: 0;
            transform: translateX(90px);
        }
        100% {
            opacity: 1;
            transform: translateX(0);
        }
    }
</style>
<!-- IntersectionObserver para activar animaciones cuando los elementos entran al viewport -->
<script>
    if (typeof window !== "undefined" && "IntersectionObserver" in window) {
        const prefersReduce = window.matchMedia(
            "(prefers-reduced-motion: reduce)",
        ).matches;
        const observer = new IntersectionObserver(
            (entries, obs) => {
                for (const entry of entries) {
                    const el = entry.target;
                    if (!(el instanceof HTMLElement)) continue;
                    if (entry.isIntersecting) {
                        // añadir la clase y dejar de observar (disparo único)
                        el.classList.add("in-view");
                        obs.unobserve(el);
                    }
                }
            },
            { threshold: 0.35 },
        );

        // Observar elementos relevantes
        [
            ...document.querySelectorAll(".animation-slide-right"),
            ...document.querySelectorAll(".animation-slide-left"),
        ].forEach((el) => {
            if (prefersReduce) el.classList.add("in-view");
            else observer.observe(el);
        });
    } else {
        // si no hay IntersectionObserver, activamos estados finales
        [
            ...document.querySelectorAll(".animation-slide-right"),
            ...document.querySelectorAll(".animation-slide-left"),
        ].forEach((el) => el.classList.add("in-view"));
    }
</script>
